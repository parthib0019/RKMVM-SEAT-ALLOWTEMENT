<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Seat Allotment System</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f4f6f9;
    }
    h1 {
      text-align: center;
      color: #333;
    }
    .form-container {
      background: white;
      padding: 20px;
      border-radius: 10px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      max-width: 600px;
      margin: auto;
    }
    label {
      font-weight: bold;
      margin-top: 10px;
      display: block;
    }
    input, select {
      width: 100%;
      padding: 8px;
      margin-top: 5px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    button {
      background: #007bff;
      color: white;
      border: none;
      padding: 15px 20px;
      border-radius: 5px;
      cursor: pointer;
    }
    button:hover {
      background: #0056b3;
    }
    table {
      width: 100%;
      margin-top: 20px;
      border-collapse: collapse;
      background: white;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 10px;
      text-align: center;
    }
    th {
      background: #007bff;
      color: white;
    }
  </style>
</head>
<body>

  <h1>Seat Allotment System</h1>
  
  <div class="form-container">
    <form id="allotmentForm">
      <label for="date">Select Date:</label>
      <input type="text" id="date" required>
     
       <label for="year">Year:</label>
      <select id="year" required>
        <option value="" disabled selected>-- Select Year --</option>
        <option>UG-I</option>
        <option>UG-II</option>
        <option>UG-III</option>
        <option>UG-IV</option>
        <option>PG-I</option>
        <option>PG-II</option>
        

      </select>

      <label for="dept">Department:</label>
      <select id="dept" required>
        <option value="" disabled selected>-- Select Department --</option>
        <option>PHYS</option>
        <option>CS</option>
        <option>MTM</option>
        <option>CHEM</option>
        <option>MCB</option>
        <option>INC</option>
        <option>ECO</option>
        <option>ZOO</option>
        <option>BEN</option>
        <option>ENG</option>
        <option>SANS</option>
        <option>HIS</option>
        <option>PHIL</option>
        <option>POLS</option>
      </select>
      
     
      
      <label for="rolls">Roll Numbers (e.g. 101,105-110,115):</label>
      <input type="text" id="rolls" placeholder="Enter roll numbers or ranges" required>

      
      <label for="room">Alloted Room:</label>
      <input type="text" id="room" placeholder="Enter Room No" required>
      
      <button type="submit">Generate Allotment</button>
    </form>
  </div>
  
  <table id="resultTable" style="display:none;">
    <thead>
      <tr>
        <th>Date</th>
        <th>Department</th>
        <th>Year</th>
        <th>Room No</th>
        <th>Allotted Roll Nos</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
  <!-- Add in <head> -->
<link rel="stylesheet" href="flatpickr.min.css">
<script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>



  <script>
    // Reformat date on change
    flatpickr("#date", {
    dateFormat: "d-m-Y",   // dd-mm-yyyy
     allowInput: true,
    defaultDate: "today",
    onReady: function(selectedDates, dateStr, instance) {
      const yearElement = instance.currentYearElement;
      const parent = yearElement.parentNode;
      const dropdown = document.createElement("select");

      function fillYears(centerYear) {
        dropdown.innerHTML = "";
        for (let y = centerYear; y <= centerYear + 80; y++) {
          const opt = document.createElement("option");
          opt.value = y;
          opt.textContent = y;
          if (y === instance.currentYear) opt.selected = true;
          dropdown.appendChild(opt);
        }
      }

      fillYears(instance.currentYear);

      dropdown.addEventListener("change", function() {
        instance.changeYear(parseInt(this.value));
});

      // when year changes via navigation, sync dropdown
      instance.config.onYearChange = function(selectedDates, dateStr, inst) {
        fillYears(inst.currentYear);
        dropdown.value = inst.currentYear;
      };

      parent.replaceChild(dropdown, yearElement);
      instance.currentYearElement = dropdown; // reassign for Flatpickr
    }
  });
    const dateInput = document.getElementById("date");
    dateInput.addEventListener("change", function() {
      let rawDate = this.value; // yyyy-mm-dd
      if(rawDate){
        let parts = rawDate.split("-");
        let formatted = `${parts[0]}-${parts[1]}-${parts[2]}`; // dd-mm-yyyy
        this.setAttribute("data-formatted", formatted); // store separately
      }
    });

    document.getElementById("allotmentForm").addEventListener("submit", function(e) {
    e.preventDefault();

    const date = document.getElementById("date").getAttribute("data-formatted");
    const dept = document.getElementById("dept").value;
    const year = document.getElementById("year").value;
    const room = document.getElementById("room").value;
    const rollInput = document.getElementById("rolls").value;

    let allottedRolls = [];

    // Parse input like 101,102,105-110
    const parts = rollInput.split(",");
    for (let part of parts) {
    part = part.trim();
    if (part.includes("-")) {
      let [start, end] = part.split("-").map(Number);
      if (!isNaN(start) && !isNaN(end)) {
        for (let i = start; i <= end; i++) {
          allottedRolls.push(i);
        }
      }
    } else {
      let roll = parseInt(part);
      if (!isNaN(roll)) {
        allottedRolls.push(roll);
        }
      }
    }

    if (allottedRolls.length === 0) {
      alert("Please enter valid roll numbers.");
      return;
    }

  // Show in table
  const table = document.getElementById("resultTable");
  const tbody = table.querySelector("tbody");
  tbody.innerHTML = `
    <tr>
      <td>${date}</td>
      <td>${dept}</td>
      <td>${year}</td>
      <td>${room}</td>
      <td>${allottedRolls.join(", ")}</td>
    </tr>
  `;
  table.style.display = "table";
});

  </script>

</body>
</html>
